Version 4
SHEET 1 2332 952
WIRE -880 -288 -880 -336
WIRE -880 -288 -1328 -288
WIRE -416 -288 -880 -288
WIRE -1328 -240 -1328 -288
WIRE -1328 -240 -1456 -240
WIRE -1008 -240 -1184 -240
WIRE -880 -240 -880 -288
WIRE -880 -240 -928 -240
WIRE -832 -240 -880 -240
WIRE -560 -240 -752 -240
WIRE -416 -240 -416 -288
WIRE -288 -240 -416 -240
WIRE -1184 -176 -1184 -240
WIRE -560 -176 -560 -240
WIRE -1456 -160 -1456 -240
WIRE -288 -160 -288 -240
WIRE -1328 -80 -1328 -240
WIRE -416 -80 -416 -240
WIRE -1184 -32 -1184 -96
WIRE -1184 -32 -1264 -32
WIRE -560 -32 -560 -96
WIRE -480 -32 -560 -32
WIRE -1680 -16 -1744 -16
WIRE -1552 -16 -1680 -16
WIRE -1456 -16 -1456 -80
WIRE -1456 -16 -1488 -16
WIRE -288 -16 -288 -80
WIRE -256 -16 -288 -16
WIRE -80 -16 -192 -16
WIRE -16 -16 -80 -16
WIRE -1456 32 -1456 -16
WIRE -1184 32 -1184 -32
WIRE -560 32 -560 -32
WIRE -288 32 -288 -16
WIRE -1328 80 -1328 16
WIRE -1328 80 -1408 80
WIRE -1040 80 -1136 80
WIRE -752 80 -752 48
WIRE -720 80 -752 80
WIRE -608 80 -640 80
WIRE -416 80 -416 16
WIRE -336 80 -416 80
WIRE -1680 96 -1680 -16
WIRE -1504 96 -1568 96
WIRE -176 96 -240 96
WIRE -80 96 -80 -16
WIRE -1040 112 -1040 80
WIRE -752 112 -752 80
WIRE -1488 224 -1488 208
WIRE -256 224 -256 208
WIRE -1040 240 -1040 192
WIRE -752 240 -752 192
WIRE -1680 288 -1680 176
WIRE -1568 288 -1568 96
WIRE -1568 288 -1680 288
WIRE -1488 288 -1568 288
WIRE -1152 288 -1152 128
WIRE -864 288 -1152 288
WIRE -592 288 -592 128
WIRE -592 288 -864 288
WIRE -176 288 -176 96
WIRE -176 288 -256 288
WIRE -80 288 -80 176
WIRE -80 288 -176 288
WIRE -1488 320 -1488 288
WIRE -256 320 -256 288
WIRE -864 384 -864 288
WIRE -912 448 -944 448
WIRE -864 512 -864 480
WIRE -272 608 -272 560
WIRE -96 608 -96 560
WIRE 48 608 48 544
WIRE -944 624 -944 448
WIRE -864 624 -864 592
WIRE -864 624 -944 624
WIRE -864 656 -864 624
WIRE -272 736 -272 688
WIRE -176 736 -272 736
WIRE -96 736 -96 688
WIRE -96 736 -176 736
WIRE 48 736 48 688
WIRE 48 736 -96 736
WIRE -176 784 -176 736
FLAG -752 48 input
IOPIN -752 48 BiDir
FLAG -752 240 0
FLAG -176 784 0
FLAG -272 560 HT+400
IOPIN -272 560 Out
FLAG 48 544 input
IOPIN 48 544 BiDir
FLAG -16 -16 output
IOPIN -16 -16 BiDir
FLAG -256 320 0
FLAG -880 -336 HT+400
IOPIN -880 -336 In
FLAG -1488 320 0
FLAG -1040 240 0
FLAG -96 560 HT-20
IOPIN -96 560 Out
FLAG -864 656 HT-20
IOPIN -864 656 In
FLAG -1744 -16 output2
IOPIN -1744 -16 BiDir
SYMBOL res -304 -176 R0
SYMATTR InstName R1
SYMATTR Value 39k
SYMBOL res -544 -192 M0
SYMATTR InstName R2
SYMATTR Value 39k
SYMBOL res -736 96 M0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL voltage -272 592 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 350
SYMBOL voltage 48 592 R0
WINDOW 123 24 44 Left 2
WINDOW 39 0 0 Left 2
SYMATTR Value2 AC 1 1
SYMATTR InstName V4
SYMATTR Value SINE(0 0.35 1k)
SYMBOL res -624 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL res -1440 -176 M0
SYMATTR InstName R7
SYMATTR Value 39k
SYMBOL res -1200 -192 R0
SYMATTR InstName R8
SYMATTR Value 39k
SYMBOL res -1024 208 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R5
SYMATTR Value 1k
SYMBOL njf -912 384 R0
SYMATTR InstName J1
SYMATTR Value BF245C
SYMBOL res -880 496 R0
SYMATTR InstName R10
SYMATTR Value 150
SYMBOL voltage -96 704 R180
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 20
SYMBOL Misc\\triode -1184 80 M0
SYMATTR InstName U7
SYMATTR Value 6F12PT
SYMBOL Misc\\triode -560 80 R0
SYMATTR InstName U8
SYMATTR Value 6F12PT
SYMBOL npn -480 -80 R0
SYMATTR InstName Q1
SYMATTR Value MJE340
SYMBOL npn -1264 -80 M0
SYMATTR InstName Q2
SYMATTR Value MJE340
SYMBOL Misc\\tetrode -288 80 M0
SYMATTR InstName U9
SYMATTR Value 6F12PP
SYMBOL Misc\\tetrode -1456 80 R0
SYMATTR InstName U10
SYMATTR Value 6F12PP
SYMBOL cap -192 -32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value 1µ
SYMBOL res -96 80 R0
SYMATTR InstName R9
SYMATTR Value 470k
SYMBOL res -1664 80 M0
SYMATTR InstName R11
SYMATTR Value 470k
SYMBOL cap -1488 -32 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 1µ
SYMBOL res -848 -224 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R3
SYMATTR Value 0.4k
SYMBOL res -1024 -224 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R6
SYMATTR Value 1.8k
SYMBOL diode -1472 144 M0
SYMATTR InstName D1
SYMATTR Value UF4007
SYMBOL diode -1472 224 M0
SYMATTR InstName D2
SYMATTR Value UF4007
SYMBOL diode -240 144 M0
SYMATTR InstName D3
SYMATTR Value UF4007
SYMBOL diode -240 224 M0
SYMATTR InstName D4
SYMATTR Value UF4007
TEXT -648 472 Left 2 !.tran 10m
TEXT -648 512 Left 2 !.Fourrier 1000 V(output)
TEXT -648 440 Left 2 !;ac oct 1000 1 1MEG
TEXT 400 -64 Left 1 !.SUBCKT 6F12PT 1 2 3 ; P G C (Triode) 07 Nov 2004\n+ params:\n+ mu  = 137.721\n+ ex  = 1.60508\n+ kg1 = 55.4076\n+ kp  = 593.725\n+ kvb = 11210.8\n+ ccg = 4.6e-12\n+ cgp = 1.6e-12\n+ ccp = 2.6e-13\ne1 7 0 value=\n+{v(1,3)/kp*log(1+exp(kp*(1/mu+v(2,3)/sqrt(kvb+v(1,3)*v(1,3)))))}\nre1 7 0 1g\ng1 1 3 value= {(pwr(v(7),ex)+pwrs(v(7),ex))/kg1}\nrcp 1 3 1g\nc1 2 3 {ccg}\nc2 1 2 {cgp}\nc3 1 3 {ccp}\n.ENDS
TEXT 400 -472 Left 1 !.SUBCKT 6F12PP    A  Gr2  Gr1  K \n*\n* Resistors in order to avoid floating nodes\n*\n* RF   F    0   1G\n*\n* Link to the generic model\n*\nXV1     A         Gr2      Gr1      K       TubePentode\n+ PARAMS: ua=164.060 ug2=2.189K xa=442.879M xg2=687.751M qa=620.235 qg2=93.692\n+ kg1=89.910 kg2=161.636 kvba=11.369 kvbg2=655.832 ce=358.645N\n*\n* Capacitances\n*\nC1    K        Gr1      6.600P   ; Ckg1\nC2    K        A        1.900P   ; Cka\nC3    Gr1      A        0.020P   ; Cg1a\n*\n* Close the model\n*\n.ENDS
TEXT 400 288 Left 1 !.SUBCKT TubePentode  A  Gr2  Gr1  K\n+ PARAMS: ua=1 ug2=1 xa=1 xg2=1 qa=1 qg2=1 kg1=1 kg2=1 kvba=1 kvbg2=1 ce=1\n*\n* Resistors in order to avoid floating nodes\n*\nR1   A    0   1G\nR2   Gr2  0   1G\nR3   Gr1  0   1G\nR4   K    0   1G\n*\n* Intermediate expressions which simplify the current calculation\n*\nRE1  1    0   1G\nE1   1    0   VALUE={xa + ce*PWR(V(A,K),2)}\nRE2  2    0   1G\nE2   2    0   VALUE={V(Gr2,K)*LOG(1 + EXP(qa*(1/ua + V(Gr1,K)/V(Gr2,K))))/qa}\nRE3  3    0   1G\nE3   3    0   VALUE={V(Gr2,K)*LOG(1 + EXP(qg2*(1/ug2 + V(Gr1,K)/V(Gr2,K))))/qg2}\n*\n* Actual current calculation\n*\nG1   A    K   VALUE={(PWR(V(2),V(1)) + PWRS(V(2),V(1)))*ATAN(V(A,K)/kvba)/kg1}\nG2   Gr2  K   VALUE={(PWR(V(3),V(1)) + PWRS(V(3),V(1)))*ATAN(V(A,K)/kvbg2)/kg2}\n*\n* Grid current modeling\n*\nRG   Gr1  4   1K\nD1   4    K   DX\n.MODEL DX D(IS=1N RS=1 CJO=10PF TT=1N)\n*\n* Close the model\n*\n.ENDS
TEXT -656 544 Left 2 !.Fourrier 1000 V(n002)
